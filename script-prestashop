<script>
  // Thierry Laval - thierrylaval.dev
  const initialTitle = document.title;
  let counter = 0;

  // Liste des messages personnalisÃ©s
  const dynamicMessages = [
    () => getCartCount() > 0 
      ? `ðŸ›ï¸ ${getCartCount()} trÃ©sor${getCartCount() > 1 ? 's' : ''} vous attend${getCartCount() > 1 ? 'ent' : ''} !`
      : "ðŸ–¤ Votre panier est bien seul...",
    () => "ðŸ”„ Une petite visite chez Thierry Laval ?",
    () => "ðŸ’¡ Vos coups de cÅ“ur sont toujours lÃ  !",
    () => "ðŸ–¤ Vous nous manquez dÃ©jÃ ..."
  ];

  // SÃ©curisation de l'accÃ¨s au panier
  function getCartCount() {
    return window?.prestashop?.cart?.products_count || 0;
  }

  const tabCheckInterval = setInterval(() => {
    const isVisible = document.visibilityState === "visible";

    if (isVisible) {
      document.title = initialTitle;
      counter = 0;
    } else {
      const messageIndex = counter % dynamicMessages.length;
      document.title = dynamicMessages[messageIndex]();
      counter++;
    }
  }, 1500); // On espace un peu plus pour un effet doux

  window.addEventListener('beforeunload', () => {
    clearInterval(tabCheckInterval);
  });
</script>
